<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Editor: Add Name & DOB on Photos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.8rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            color: #666;
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .main-app {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }

        .editor-panel {
            flex: 1;
            min-width: 350px;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        .preview-panel {
            flex: 1.5;
            min-width: 500px;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }

        .panel-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .panel-title i {
            color: #667eea;
            background: #f0f0f0;
            padding: 10px;
            border-radius: 10px;
        }

        .form-section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eee;
        }

        .section-title {
            font-size: 1.2rem;
            color: #444;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
            font-size: 0.95rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(102, 126, 234, 0.05);
            margin-bottom: 20px;
        }

        .upload-area:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-3px);
        }

        .upload-area i {
            font-size: 60px;
            color: #667eea;
            margin-bottom: 15px;
            opacity: 0.8;
        }

        .upload-area p {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .upload-area span {
            color: #764ba2;
            font-weight: 600;
        }

        #fileInput {
            display: none;
        }

        .image-preview {
            margin-top: 20px;
            text-align: center;
        }

        #uploadedImage {
            max-width: 100%;
            max-height: 200px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .text-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .text-input-group {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .text-preview {
            font-size: 1.2rem;
            text-align: center;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            margin-top: 10px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #ddd;
        }

        .font-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .font-option {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }

        .font-option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .font-option.active {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .color-picker {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.active {
            border-color: #333;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .slider-group {
            margin-top: 10px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider-container input[type="range"] {
            flex: 1;
        }

        .slider-value {
            min-width: 50px;
            text-align: center;
            font-weight: 600;
            color: #667eea;
            background: #f0f0f0;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .position-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .position-btn {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            background: white;
            font-size: 1.5rem;
        }

        .position-btn:hover {
            border-color: #667eea;
        }

        .position-btn.active {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            background: #f8f9ff;
            padding: 10px 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 140px;
        }

        .checkbox-label input {
            width: auto;
        }

        .preview-container {
            flex: 1;
            border: 3px dashed #ddd;
            border-radius: 15px;
            padding: 20px;
            background: #f8f9ff;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            min-height: 400px;
        }

        #photoCanvas {
            max-width: 100%;
            max-height: 100%;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .canvas-placeholder {
            text-align: center;
            color: #888;
            font-size: 1.1rem;
        }

        .canvas-placeholder i {
            font-size: 60px;
            color: #ccc;
            margin-bottom: 20px;
            display: block;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 16px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #2ecc71;
            color: white;
        }

        .btn-secondary:hover {
            background: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
        }

        .btn-download {
            background: #e74c3c;
            color: white;
        }

        .btn-download:hover {
            background: #c0392b;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(231, 76, 60, 0.3);
        }

        .btn-clear {
            background: #f39c12;
            color: white;
        }

        .btn-clear:hover {
            background: #d68910;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(243, 156, 18, 0.3);
        }

        .templates {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .template-card {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .template-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
        }

        .template-card.active {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .template-icon {
            font-size: 30px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: #2ecc71;
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .notification.error {
            background: #e74c3c;
        }

        .quick-presets {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .preset-btn {
            padding: 8px 15px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .preset-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .text-layer {
            position: absolute;
            pointer-events: none;
            user-select: none;
        }

        .draggable-text {
            position: absolute;
            cursor: move;
            padding: 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }

        .draggable-text:hover {
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .text-controls {
            position: absolute;
            top: -30px;
            right: 0;
            display: flex;
            gap: 5px;
        }

        .text-control-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #333;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }

        @media (max-width: 1100px) {
            .main-app {
                flex-direction: column;
            }
            
            .editor-panel, .preview-panel {
                min-width: 100%;
            }
            
            .text-inputs {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .font-options {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .templates {
                grid-template-columns: repeat(2, 1fr);
            }
            
            h1 {
                font-size: 2rem;
            }
        }

        .tab-navigation {
            display: flex;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .tab-btn {
            flex: 1;
            padding: 20px;
            background: #f8f9ff;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: #666;
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .watermark-preview {
            margin-top: 15px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 10px;
            border: 2px dashed #ddd;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dob-format {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .dob-format select {
            flex: 1;
        }

        .signature-canvas {
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-top: 15px;
            cursor: crosshair;
            background: white;
        }

        .canvas-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .canvas-btn {
            padding: 8px 15px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .canvas-btn.clear {
            background: #e74c3c;
            color: white;
            border-color: #e74c3c;
        }

        .canvas-btn.save {
            background: #2ecc71;
            color: white;
            border-color: #2ecc71;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-camera"></i> Photo Editor: Add Name & DOB</h1>
            <p class="subtitle">Add custom text, signatures, watermarks, and more to your photos. Perfect for ID cards, certificates, and personal photos.</p>
        </header>

        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="basic-tab">
                <i class="fas fa-edit"></i> Basic Editor
            </button>
            <button class="tab-btn" data-tab="advanced-tab">
                <i class="fas fa-sliders-h"></i> Advanced Editor
            </button>
            <button class="tab-btn" data-tab="templates-tab">
                <i class="fas fa-images"></i> Templates
            </button>
        </div>

        <!-- Basic Editor Tab -->
        <div class="tab-content active" id="basic-tab">
            <div class="main-app">
                <div class="editor-panel">
                    <div class="panel-title">
                        <i class="fas fa-sliders-h"></i> Editor Settings
                    </div>

                    <!-- Photo Upload Section -->
                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-cloud-upload-alt"></i> Upload Photo
                        </div>
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Drag & drop your photo here</p>
                            <p><span>or click to browse</span></p>
                            <input type="file" id="fileInput" accept="image/*">
                        </div>
                        <div class="image-preview">
                            <img id="uploadedImage" alt="Uploaded Photo">
                        </div>
                    </div>

                    <!-- Text Input Section -->
                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-font"></i> Add Text to Photo
                        </div>
                        <div class="text-inputs">
                            <div class="text-input-group">
                                <label for="nameText"><i class="fas fa-user"></i> Full Name</label>
                                <input type="text" id="nameText" placeholder="Enter your full name" value="John Smith">
                            </div>
                            <div class="text-input-group">
                                <label for="dobText"><i class="fas fa-birthday-cake"></i> Date of Birth</label>
                                <input type="date" id="dobText">
                            </div>
                        </div>
                        <div class="dob-format">
                            <select id="dobFormat">
                                <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                <option value="Month DD, YYYY">Month DD, YYYY</option>
                                <option value="DD Month YYYY">DD Month YYYY</option>
                            </select>
                            <button id="addTextBtn" class="btn" style="background: #667eea; color: white; padding: 0 20px;">
                                <i class="fas fa-plus"></i> Add
                            </button>
                        </div>

                        <!-- Additional Text Fields -->
                        <div class="text-inputs" style="margin-top: 20px;">
                            <div class="text-input-group">
                                <label for="additionalText1"><i class="fas fa-tag"></i> Additional Text 1</label>
                                <input type="text" id="additionalText1" placeholder="e.g., Employee ID">
                            </div>
                            <div class="text-input-group">
                                <label for="additionalText2"><i class="fas fa-tag"></i> Additional Text 2</label>
                                <input type="text" id="additionalText2" placeholder="e.g., Department">
                            </div>
                        </div>
                    </div>

                    <!-- Quick Presets -->
                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-bolt"></i> Quick Presets
                        </div>
                        <div class="quick-presets">
                            <button class="preset-btn" data-preset="id-card">ID Card</button>
                            <button class="preset-btn" data-preset="certificate">Certificate</button>
                            <button class="preset-btn" data-preset="birthday">Birthday Photo</button>
                            <button class="preset-btn" data-preset="wedding">Wedding Photo</button>
                            <button class="preset-btn" data-preset="social-media">Social Media</button>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-cogs"></i> Actions
                        </div>
                        <div class="action-buttons">
                            <button id="applyBtn" class="btn btn-primary">
                                <i class="fas fa-check"></i> Apply Changes
                            </button>
                            <button id="resetBtn" class="btn btn-clear">
                                <i class="fas fa-redo"></i> Reset All
                            </button>
                            <button id="downloadBtn" class="btn btn-download">
                                <i class="fas fa-download"></i> Download Photo
                            </button>
                        </div>
                    </div>
                </div>

                <div class="preview-panel">
                    <div class="panel-title">
                        <i class="fas fa-eye"></i> Photo Preview
                    </div>
                    <div class="preview-container" id="previewContainer">
                        <canvas id="photoCanvas"></canvas>
                        <div class="canvas-placeholder" id="canvasPlaceholder">
                            <i class="fas fa-image"></i>
                            <p>Upload a photo to begin editing</p>
                            <p style="font-size: 0.9rem; color: #aaa; margin-top: 10px;">
                                Supported formats: JPG, PNG, GIF, WebP
                            </p>
                        </div>
                        <div id="textLayers"></div>
                    </div>
                    
                    <div class="action-buttons" style="margin-top: 20px;">
                        <button id="saveTemplateBtn" class="btn btn-secondary">
                            <i class="fas fa-save"></i> Save as Template
                        </button>
                        <button id="shareBtn" class="btn" style="background: #3498db; color: white;">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                        <button id="printBtn" class="btn" style="background: #95a5a6; color: white;">
                            <i class="fas fa-print"></i> Print
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Editor Tab -->
        <div class="tab-content" id="advanced-tab">
            <div class="main-app">
                <div class="editor-panel">
                    <div class="panel-title">
                        <i class="fas fa-magic"></i> Advanced Settings
                    </div>

                    <!-- Text Customization -->
                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-paint-brush"></i> Text Customization
                        </div>
                        
                        <div class="form-group">
                            <label>Font Family</label>
                            <div class="font-options">
                                <div class="font-option active" data-font="Arial">
                                    <div style="font-family: Arial">Arial</div>
                                </div>
                                <div class="font-option" data-font="Times New Roman">
                                    <div style="font-family: 'Times New Roman'">Times</div>
                                </div>
                                <div class="font-option" data-font="Georgia">
                                    <div style="font-family: Georgia">Georgia</div>
                                </div>
                                <div class="font-option" data-font="Courier New">
                                    <div style="font-family: 'Courier New'">Courier</div>
                                </div>
                                <div class="font-option" data-font="Verdana">
                                    <div style="font-family: Verdana">Verdana</div>
                                </div>
                                <div class="font-option" data-font="Brush Script MT">
                                    <div style="font-family: 'Brush Script MT'">Script</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Text Color</label>
                            <div class="color-picker">
                                <div class="color-option active" style="background: #000000;" data-color="#000000"></div>
                                <div class="color-option" style="background: #ffffff; border: 1px solid #ccc;" data-color="#ffffff"></div>
                                <div class="color-option" style="background: #ff0000;" data-color="#ff0000"></div>
                                <div class="color-option" style="background: #0000ff;" data-color="#0000ff"></div>
                                <div class="color-option" style="background: #008000;" data-color="#008000"></div>
                                <div class="color-option" style="background: #ffa500;" data-color="#ffa500"></div>
                                <input type="color" id="customColor" value="#000000" style="width: 40px; height: 40px; border-radius: 50%; overflow: hidden;">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Font Size: <span id="fontSizeValue">24</span>px</label>
                            <div class="slider-container">
                                <input type="range" id="fontSize" min="10" max="100" value="24">
                                <span class="slider-value" id="fontSizeDisplay">24px</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Text Opacity: <span id="opacityValue">100</span>%</label>
                            <div class="slider-container">
                                <input type="range" id="textOpacity" min="10" max="100" value="100">
                                <span class="slider-value" id="opacityDisplay">100%</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Text Effects</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="boldText"> Bold
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="italicText"> Italic
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="underlineText"> Underline
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="shadowText"> Shadow
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Text Position -->
                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-arrows-alt"></i> Text Position
                        </div>
                        <div class="position-selector">
                            <button class="position-btn" data-position="top-left">↖</button>
                            <button class="position-btn" data-position="top-center">↑</button>
                            <button class="position-btn" data-position="top-right">↗</button>
                            <button class="position-btn" data-position="middle-left">←</button>
                            <button class="position-btn active" data-position="center">⦿</button>
                            <button class="position-btn" data-position="middle-right">→</button>
                            <button class="position-btn" data-position="bottom-left">↙</button>
                            <button class="position-btn" data-position="bottom-center">↓</button>
                            <button class="position-btn" data-position="bottom-right">↘</button>
                        </div>
                        <div style="margin-top: 15px; text-align: center;">
                            <p style="color: #666; font-size: 0.9rem;">
                                You can also drag text to any position in the preview
                            </p>
                        </div>
                    </div>

                    <!-- Background Effects -->
                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-image"></i> Background Effects
                        </div>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="blurBackground"> Blur Background
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="darkenBackground"> Darken Background
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="addOverlay"> Add Color Overlay
                            </label>
                        </div>
                        <div id="overlayOptions" style="display: none; margin-top: 15px;">
                            <label>Overlay Color</label>
                            <input type="color" id="overlayColor" value="#000000">
                            <div class="slider-container" style="margin-top: 10px;">
                                <label>Overlay Opacity</label>
                                <input type="range" id="overlayOpacity" min="10" max="90" value="50">
                                <span class="slider-value" id="overlayOpacityDisplay">50%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="preview-panel">
                    <div class="panel-title">
                        <i class="fas fa-sliders-h"></i> Advanced Preview
                    </div>
                    <div class="preview-container" id="advancedPreview">
                        <!-- Same as basic preview -->
                    </div>
                    
                    <!-- Signature Section -->
                    <div class="form-section" style="margin-top: 20px;">
                        <div class="section-title">
                            <i class="fas fa-signature"></i> Add Signature
                        </div>
                        <div style="text-align: center;">
                            <p style="color: #666; margin-bottom: 10px;">Draw your signature below</p>
                            <canvas id="signatureCanvas" width="400" height="150" class="signature-canvas"></canvas>
                            <div class="canvas-controls">
                                <button id="clearSignature" class="canvas-btn clear">
                                    <i class="fas fa-trash"></i> Clear
                                </button>
                                <button id="saveSignature" class="canvas-btn save">
                                    <i class="fas fa-save"></i> Save Signature
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Templates Tab -->
        <div class="tab-content" id="templates-tab">
            <div class="main-app">
                <div class="editor-panel">
                    <div class="panel-title">
                        <i class="fas fa-th-large"></i> Photo Templates
                    </div>

                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-layer-group"></i> Choose Template
                        </div>
                        <div class="templates">
                            <div class="template-card active" data-template="id-card">
                                <div class="template-icon">
                                    <i class="fas fa-id-card"></i>
                                </div>
                                <h4>ID Card</h4>
                                <p style="font-size: 0.8rem; color: #666;">Professional identification card</p>
                            </div>
                            <div class="template-card" data-template="certificate">
                                <div class="template-icon">
                                    <i class="fas fa-award"></i>
                                </div>
                                <h4>Certificate</h4>
                                <p style="font-size: 0.8rem; color: #666;">Award or achievement certificate</p>
                            </div>
                            <div class="template-card" data-template="birth-certificate">
                                <div class="template-icon">
                                    <i class="fas fa-baby"></i>
                                </div>
                                <h4>Birth Certificate</h4>
                                <p style="font-size: 0.8rem; color: #666;">Birth announcement format</p>
                            </div>
                            <div class="template-card" data-template="passport">
                                <div class="template-icon">
                                    <i class="fas fa-passport"></i>
                                </div>
                                <h4>Passport Photo</h4>
                                <p style="font-size: 0.8rem; color: #666;">Official passport format</p>
                            </div>
                            <div class="template-card" data-template="social-media">
                                <div class="template-icon">
                                    <i class="fas fa-share-alt"></i>
                                </div>
                                <h4>Social Media</h4>
                                <p style="font-size: 0.8rem; color: #666;">Profile picture with text overlay</p>
                            </div>
                            <div class="template-card" data-template="custom">
                                <div class="template-icon">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <h4>Custom</h4>
                                <p style="font-size: 0.8rem; color: #666;">Create your own design</p>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="section-title">
                            <i class="fas fa-palette"></i> Template Customization
                        </div>
                        <div class="form-group">
                            <label>Template Size</label>
                            <select id="templateSize">
                                <option value="standard">Standard (3.5" x 2")</option>
                                <option value="passport">Passport (2" x 2")</option>
                                <option value="a4">A4 (8.3" x 11.7")</option>
                                <option value="square">Square (1080 x 1080)</option>
                                <option value="custom">Custom Size</option>
                            </select>
                        </div>

                        <div id="customSizeFields" style="display: none; margin-top: 15px;">
                            <div style="display: flex; gap: 10px;">
                                <input type="number" id="customWidth" placeholder="Width (px)" min="100" max="4000" style="flex: 1;">
                                <input type="number" id="customHeight" placeholder="Height (px)" min="100" max="4000" style="flex: 1;">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Background Color</label>
                            <input type="color" id="templateBgColor" value="#ffffff">
                        </div>

                        <div class="form-group">
                            <label>Border Style</label>
                            <select id="borderStyle">
                                <option value="none">No Border</option>
                                <option value="solid">Solid</option>
                                <option value="dashed">Dashed</option>
                                <option value="dotted">Dotted</option>
                                <option value="double">Double</option>
                            </select>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button id="applyTemplateBtn" class="btn btn-primary">
                            <i class="fas fa-check"></i> Apply Template
                        </button>
                        <button id="saveTemplateBtn2" class="btn btn-secondary">
                            <i class="fas fa-save"></i> Save Template
                        </button>
                    </div>
                </div>

                <div class="preview-panel">
                    <div class="panel-title">
                        <i class="fas fa-eye"></i> Template Preview
                    </div>
                    <div class="preview-container">
                        <div id="templatePreview" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                            <div style="text-align: center; color: #666;">
                                <i class="fas fa-th-large" style="font-size: 60px; color: #ccc; margin-bottom: 20px;"></i>
                                <p>Select a template to preview</p>
                                <p style="font-size: 0.9rem; color: #aaa; margin-top: 10px;">
                                    Template will be applied to your uploaded photo
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section" style="margin-top: 20px;">
                        <div class="section-title">
                            <i class="fas fa-water"></i> Watermark
                        </div>
                        <div class="watermark-preview" id="watermarkPreview">
                            <p style="color: #aaa;">Watermark preview will appear here</p>
                        </div>
                        <div style="margin-top: 15px;">
                            <button id="addWatermarkBtn" class="btn" style="background: #9b59b6; color: white; width: 100%;">
                                <i class="fas fa-water"></i> Add Watermark
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification -->
        <div class="notification" id="notification">
            <i class="fas fa-check-circle"></i>
            <span>Photo saved successfully!</span>
        </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // DOM Elements
        const tabButtons = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const uploadedImage = document.getElementById('uploadedImage');
        const photoCanvas = document.getElementById('photoCanvas');
        const canvasPlaceholder = document.getElementById('canvasPlaceholder');
        const previewContainer = document.getElementById('previewContainer');
        const nameText = document.getElementById('nameText');
        const dobText = document.getElementById('dobText');
        const dobFormat = document.getElementById('dobFormat');
        const additionalText1 = document.getElementById('additionalText1');
        const additionalText2 = document.getElementById('additionalText2');
        const addTextBtn = document.getElementById('addTextBtn');
        const applyBtn = document.getElementById('applyBtn');
        const resetBtn = document.getElementById('resetBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const notification = document.getElementById('notification');
        const textLayers = document.getElementById('textLayers');
        
        // Advanced editor elements
        const fontOptions = document.querySelectorAll('.font-option');
        const colorOptions = document.querySelectorAll('.color-option');
        const customColor = document.getElementById('customColor');
        const fontSize = document.getElementById('fontSize');
        const fontSizeValue = document.getElementById('fontSizeValue');
        const fontSizeDisplay = document.getElementById('fontSizeDisplay');
        const textOpacity = document.getElementById('textOpacity');
        const opacityValue = document.getElementById('opacityValue');
        const opacityDisplay = document.getElementById('opacityDisplay');
        const boldText = document.getElementById('boldText');
        const italicText = document.getElementById('italicText');
        const underlineText = document.getElementById('underlineText');
        const shadowText = document.getElementById('shadowText');
        const positionButtons = document.querySelectorAll('.position-btn');
        const blurBackground = document.getElementById('blurBackground');
        const darkenBackground = document.getElementById('darkenBackground');
        const addOverlay = document.getElementById('addOverlay');
        const overlayOptions = document.getElementById('overlayOptions');
        const overlayColor = document.getElementById('overlayColor');
        const overlayOpacity = document.getElementById('overlayOpacity');
        const overlayOpacityDisplay = document.getElementById('overlayOpacityDisplay');
        
        // Template elements
        const templateCards = document.querySelectorAll('.template-card');
        const templateSize = document.getElementById('templateSize');
        const customSizeFields = document.getElementById('customSizeFields');
        const customWidth = document.getElementById('customWidth');
        const customHeight = document.getElementById('customHeight');
        const templateBgColor = document.getElementById('templateBgColor');
        const borderStyle = document.getElementById('borderStyle');
        const applyTemplateBtn = document.getElementById('applyTemplateBtn');
        const addWatermarkBtn = document.getElementById('addWatermarkBtn');
        
        // Signature canvas
        const signatureCanvas = document.getElementById('signatureCanvas');
        const clearSignature = document.getElementById('clearSignature');
        const saveSignature = document.getElementById('saveSignature');
        
        // Preset buttons
        const presetButtons = document.querySelectorAll('.preset-btn');
        
        // State variables
        let originalImage = null;
        let canvasContext = null;
        let currentImage = null;
        let textElements = [];
        let currentFont = 'Arial';
        let currentColor = '#000000';
        let currentPosition = 'center';
        let currentTemplate = 'id-card';
        let signatureData = null;
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        
        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            // Set today's date as default DOB
            const today = new Date().toISOString().split('T')[0];
            dobText.value = today;
            
            // Initialize canvas context
            canvasContext = photoCanvas.getContext('2d');
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize signature canvas
            initSignatureCanvas();
        });
        
        // Setup event listeners
        function setupEventListeners() {
            // Tab switching
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.dataset.tab;
                    
                    // Update active tab button
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Update active tab content
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // File upload
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.background = 'rgba(102, 126, 234, 0.15)';
                uploadArea.style.borderColor = '#764ba2';
            });
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.background = 'rgba(102, 126, 234, 0.05)';
                uploadArea.style.borderColor = '#667eea';
            });
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.background = 'rgba(102, 126, 234, 0.05)';
                uploadArea.style.borderColor = '#667eea';
                
                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    handleImageUpload(file);
                }
            });
            fileInput.addEventListener('change', (e) => {
                if (e.target.files[0]) {
                    handleImageUpload(e.target.files[0]);
                }
            });
            
            // Text styling
            fontOptions.forEach(option => {
                option.addEventListener('click', () => {
                    fontOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    currentFont = option.dataset.font;
                    updateTextElements();
                });
            });
            
            colorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    colorOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    currentColor = option.dataset.color;
                    customColor.value = currentColor;
                    updateTextElements();
                });
            });
            
            customColor.addEventListener('input', (e) => {
                currentColor = e.target.value;
                updateTextElements();
            });
            
            fontSize.addEventListener('input', (e) => {
                fontSizeValue.textContent = e.target.value;
                fontSizeDisplay.textContent = e.target.value + 'px';
                updateTextElements();
            });
            
            textOpacity.addEventListener('input', (e) => {
                opacityValue.textContent = e.target.value;
                opacityDisplay.textContent = e.target.value + '%';
                updateTextElements();
            });
            
            // Text effects
            [boldText, italicText, underlineText, shadowText].forEach(checkbox => {
                checkbox.addEventListener('change', updateTextElements);
            });
            
            // Position buttons
            positionButtons.forEach(button => {
                button.addEventListener('click', () => {
                    positionButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentPosition = button.dataset.position;
                    updateTextPositions();
                });
            });
            
            // Background effects
            addOverlay.addEventListener('change', () => {
                overlayOptions.style.display = addOverlay.checked ? 'block' : 'none';
                applyChanges();
            });
            
            overlayOpacity.addEventListener('input', (e) => {
                overlayOpacityDisplay.textContent = e.target.value + '%';
                applyChanges();
            });
            
            // Template selection
            templateCards.forEach(card => {
                card.addEventListener('click', () => {
                    templateCards.forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                    currentTemplate = card.dataset.template;
                    updateTemplatePreview();
                });
            });
            
            templateSize.addEventListener('change', () => {
                customSizeFields.style.display = templateSize.value === 'custom' ? 'block' : 'none';
                updateTemplatePreview();
            });
            
            // Preset buttons
            presetButtons.forEach(button => {
                button.addEventListener('click', () => {
                    applyPreset(button.dataset.preset);
                });
            });
            
            // Action buttons
            addTextBtn.addEventListener('click', addTextToCanvas);
            applyBtn.addEventListener('click', applyChanges);
            resetBtn.addEventListener('click', resetEditor);
            downloadBtn.addEventListener('click', downloadImage);
            applyTemplateBtn.addEventListener('click', applyTemplate);
            addWatermarkBtn.addEventListener('click', addWatermark);
            
            // Share and print buttons
            document.getElementById('shareBtn').addEventListener('click', shareImage);
            document.getElementById('printBtn').addEventListener('click', printImage);
        }
        
        // Handle image upload
        function handleImageUpload(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                originalImage = new Image();
                originalImage.onload = () => {
                    // Show uploaded image preview
                    uploadedImage.src = e.target.result;
                    uploadedImage.style.display = 'block';
                    
                    // Setup canvas
                    setupCanvas(originalImage);
                    
                    // Hide placeholder
                    canvasPlaceholder.style.display = 'none';
                    photoCanvas.style.display = 'block';
                    
                    // Apply default text
                    addDefaultText();
                    
                    showNotification('Photo uploaded successfully!');
                };
                originalImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        // Setup canvas
        function setupCanvas(image) {
            const maxWidth = previewContainer.clientWidth - 40;
            const maxHeight = previewContainer.clientHeight - 40;
            
            let width = image.width;
            let height = image.height;
            
            // Scale image to fit container
            if (width > maxWidth) {
                const ratio = maxWidth / width;
                width = maxWidth;
                height = height * ratio;
            }
            
            if (height > maxHeight) {
                const ratio = maxHeight / height;
                height = maxHeight;
                width = width * ratio;
            }
            
            // Set canvas dimensions
            photoCanvas.width = width;
            photoCanvas.height = height;
            
            // Draw image on canvas
            canvasContext.clearRect(0, 0, photoCanvas.width, photoCanvas.height);
            canvasContext.drawImage(image, 0, 0, width, height);
            
            currentImage = image;
        }
        
        // Add default text
        function addDefaultText() {
            textElements = [];
            
            // Add name text
            if (nameText.value.trim()) {
                addTextElement({
                    text: nameText.value.trim(),
                    x: photoCanvas.width / 2,
                    y: photoCanvas.height - 100,
                    fontSize: 24,
                    color: currentColor,
                    font: currentFont
                });
            }
            
            // Add DOB text
            if (dobText.value) {
                const dob = formatDate(dobText.value, dobFormat.value);
                addTextElement({
                    text: `DOB: ${dob}`,
                    x: photoCanvas.width / 2,
                    y: photoCanvas.height - 60,
                    fontSize: 18,
                    color: currentColor,
                    font: currentFont
                });
            }
            
            renderTextElements();
        }
        
        // Format date based on selected format
        function formatDate(dateString, format) {
            const date = new Date(dateString);
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();
            const monthNames = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            
            switch(format) {
                case 'DD/MM/YYYY':
                    return `${day}/${month}/${year}`;
                case 'MM/DD/YYYY':
                    return `${month}/${day}/${year}`;
                case 'Month DD, YYYY':
                    return `${monthNames[date.getMonth()]} ${day}, ${year}`;
                case 'DD Month YYYY':
                    return `${day} ${monthNames[date.getMonth()]} ${year}`;
                default:
                    return `${day}/${month}/${year}`;
            }
        }
        
        // Add text element
        function addTextElement(options) {
            const textElement = {
                id: Date.now() + Math.random(),
                text: options.text,
                x: options.x || photoCanvas.width / 2,
                y: options.y || photoCanvas.height / 2,
                fontSize: options.fontSize || 24,
                color: options.color || currentColor,
                font: options.font || currentFont,
                bold: options.bold || false,
                italic: options.italic || false,
                underline: options.underline || false,
                shadow: options.shadow || false,
                opacity: options.opacity || 100,
                draggable: true
            };
            
            textElements.push(textElement);
            createDraggableText(textElement);
        }
        
        // Create draggable text element
        function createDraggableText(textElement) {
            const textDiv = document.createElement('div');
            textDiv.className = 'draggable-text';
            textDiv.id = `text-${textElement.id}`;
            textDiv.style.position = 'absolute';
            textDiv.style.left = `${textElement.x}px`;
            textDiv.style.top = `${textElement.y}px`;
            textDiv.style.transform = 'translate(-50%, -50%)';
            textDiv.style.color = textElement.color;
            textDiv.style.fontFamily = textElement.font;
            textDiv.style.fontSize = `${textElement.fontSize}px`;
            textDiv.style.fontWeight = textElement.bold ? 'bold' : 'normal';
            textDiv.style.fontStyle = textElement.italic ? 'italic' : 'normal';
            textDiv.style.textDecoration = textElement.underline ? 'underline' : 'none';
            textDiv.style.opacity = textElement.opacity / 100;
            textDiv.style.textShadow = textElement.shadow ? '2px 2px 4px rgba(0,0,0,0.5)' : 'none';
            textDiv.style.whiteSpace = 'nowrap';
            textDiv.style.padding = '5px 10px';
            textDiv.style.borderRadius = '5px';
            textDiv.style.background = 'rgba(255, 255, 255, 0.8)';
            textDiv.style.cursor = 'move';
            textDiv.textContent = textElement.text;
            
            // Add controls
            const controlsDiv = document.createElement('div');
            controlsDiv.className = 'text-controls';
            
            const editBtn = document.createElement('button');
            editBtn.className = 'text-control-btn';
            editBtn.innerHTML = '<i class="fas fa-edit"></i>';
            editBtn.title = 'Edit Text';
            editBtn.onclick = (e) => {
                e.stopPropagation();
                editText(textElement.id);
            };
            
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'text-control-btn';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.title = 'Delete Text';
            deleteBtn.onclick = (e) => {
                e.stopPropagation();
                deleteText(textElement.id);
            };
            
            controlsDiv.appendChild(editBtn);
            controlsDiv.appendChild(deleteBtn);
            textDiv.appendChild(controlsDiv);
            textLayers.appendChild(textDiv);
            
            // Make draggable
            makeDraggable(textDiv, textElement);
        }
        
        // Make element draggable
        function makeDraggable(element, textElement) {
            let isDragging = false;
            let offsetX, offsetY;
            
            element.addEventListener('mousedown', startDrag);
            element.addEventListener('touchstart', startDragTouch);
            
            function startDrag(e) {
                isDragging = true;
                const rect = element.getBoundingClientRect();
                offsetX = e.clientX - rect.left;
                offsetY = e.clientY - rect.top;
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDrag);
            }
            
            function startDragTouch(e) {
                isDragging = true;
                const touch = e.touches[0];
                const rect = element.getBoundingClientRect();
                offsetX = touch.clientX - rect.left;
                offsetY = touch.clientY - rect.top;
                document.addEventListener('touchmove', dragTouch);
                document.addEventListener('touchend', stopDrag);
            }
            
            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();
                
                const containerRect = previewContainer.getBoundingClientRect();
                const x = e.clientX - containerRect.left - offsetX;
                const y = e.clientY - containerRect.top - offsetY;
                
                // Keep within bounds
                const maxX = containerRect.width - element.offsetWidth;
                const maxY = containerRect.height - element.offsetHeight;
                
                const boundedX = Math.max(0, Math.min(x, maxX));
                const boundedY = Math.max(0, Math.min(y, maxY));
                
                element.style.left = `${boundedX}px`;
                element.style.top = `${boundedY}px`;
                
                // Update text element position
                textElement.x = boundedX + element.offsetWidth / 2;
                textElement.y = boundedY + element.offsetHeight / 2;
            }
            
            function dragTouch(e) {
                if (!isDragging) return;
                e.preventDefault();
                
                const touch = e.touches[0];
                const containerRect = previewContainer.getBoundingClientRect();
                const x = touch.clientX - containerRect.left - offsetX;
                const y = touch.clientY - containerRect.top - offsetY;
                
                // Keep within bounds
                const maxX = containerRect.width - element.offsetWidth;
                const maxY = containerRect.height - element.offsetHeight;
                
                const boundedX = Math.max(0, Math.min(x, maxX));
                const boundedY = Math.max(0, Math.min(y, maxY));
                
                element.style.left = `${boundedX}px`;
                element.style.top = `${boundedY}px`;
                
                // Update text element position
                textElement.x = boundedX + element.offsetWidth / 2;
                textElement.y = boundedY + element.offsetHeight / 2;
            }
            
            function stopDrag() {
                isDragging = false;
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
                document.removeEventListener('touchmove', dragTouch);
                document.removeEventListener('touchend', stopDrag);
            }
        }
        
        // Edit text
        function editText(id) {
            const textElement = textElements.find(t => t.id === id);
            if (!textElement) return;
            
            const newText = prompt('Edit text:', textElement.text);
            if (newText !== null) {
                textElement.text = newText;
                updateTextElement(textElement);
                renderTextElements();
            }
        }
        
        // Delete text
        function deleteText(id) {
            textElements = textElements.filter(t => t.id !== id);
            const textDiv = document.getElementById(`text-${id}`);
            if (textDiv) {
                textDiv.remove();
            }
            renderTextElements();
        }
        
        // Update text element
        function updateTextElement(textElement) {
            const textDiv = document.getElementById(`text-${textElement.id}`);
            if (textDiv) {
                textDiv.textContent = textElement.text;
                textDiv.style.color = textElement.color;
                textDiv.style.fontFamily = textElement.font;
                textDiv.style.fontSize = `${textElement.fontSize}px`;
                textDiv.style.fontWeight = textElement.bold ? 'bold' : 'normal';
                textDiv.style.fontStyle = textElement.italic ? 'italic' : 'normal';
                textDiv.style.textDecoration = textElement.underline ? 'underline' : 'none';
                textDiv.style.opacity = textElement.opacity / 100;
                textDiv.style.textShadow = textElement.shadow ? '2px 2px 4px rgba(0,0,0,0.5)' : 'none';
            }
        }
        
        // Update all text elements
        function updateTextElements() {
            textElements.forEach(textElement => {
                textElement.color = currentColor;
                textElement.font = currentFont;
                textElement.fontSize = parseInt(fontSize.value);
                textElement.bold = boldText.checked;
                textElement.italic = italicText.checked;
                textElement.underline = underlineText.checked;
                textElement.shadow = shadowText.checked;
                textElement.opacity = parseInt(textOpacity.value);
                updateTextElement(textElement);
            });
            renderTextElements();
        }
        
        // Update text positions based on selected position
        function updateTextPositions() {
            if (textElements.length === 0) return;
            
            const positions = {
                'top-left': { x: 100, y: 100 },
                'top-center': { x: photoCanvas.width / 2, y: 100 },
                'top-right': { x: photoCanvas.width - 100, y: 100 },
                'middle-left': { x: 100, y: photoCanvas.height / 2 },
                'center': { x: photoCanvas.width / 2, y: photoCanvas.height / 2 },
                'middle-right': { x: photoCanvas.width - 100, y: photoCanvas.height / 2 },
                'bottom-left': { x: 100, y: photoCanvas.height - 100 },
                'bottom-center': { x: photoCanvas.width / 2, y: photoCanvas.height - 100 },
                'bottom-right': { x: photoCanvas.width - 100, y: photoCanvas.height - 100 }
            };
            
            const position = positions[currentPosition];
            if (!position) return;
            
            textElements.forEach((textElement, index) => {
                textElement.x = position.x;
                textElement.y = position.y + (index * 60);
                
                const textDiv = document.getElementById(`text-${textElement.id}`);
                if (textDiv) {
                    textDiv.style.left = `${textElement.x}px`;
                    textDiv.style.top = `${textElement.y}px`;
                    textDiv.style.transform = 'translate(-50%, -50%)';
                }
            });
            
            renderTextElements();
        }
        
        // Render text elements on canvas
        function renderTextElements() {
            if (!currentImage) return;
            
            // Redraw original image
            setupCanvas(currentImage);
            
            // Apply background effects
            applyBackgroundEffects();
            
            // Draw text elements
            textElements.forEach(textElement => {
                canvasContext.save();
                
                // Set text properties
                canvasContext.font = `${textElement.bold ? 'bold ' : ''}${textElement.italic ? 'italic ' : ''}${textElement.fontSize}px ${textElement.font}`;
                canvasContext.fillStyle = textElement.color;
                canvasContext.globalAlpha = textElement.opacity / 100;
                canvasContext.textAlign = 'center';
                canvasContext.textBaseline = 'middle';
                
                // Add text shadow
                if (textElement.shadow) {
                    canvasContext.shadowColor = 'rgba(0, 0, 0, 0.5)';
                    canvasContext.shadowBlur = 4;
                    canvasContext.shadowOffsetX = 2;
                    canvasContext.shadowOffsetY = 2;
                }
                
                // Underline
                if (textElement.underline) {
                    const textWidth = canvasContext.measureText(textElement.text).width;
                    canvasContext.beginPath();
                    canvasContext.moveTo(textElement.x - textWidth / 2, textElement.y + textElement.fontSize / 2);
                    canvasContext.lineTo(textElement.x + textWidth / 2, textElement.y + textElement.fontSize / 2);
                    canvasContext.strokeStyle = textElement.color;
                    canvasContext.lineWidth = 2;
                    canvasContext.stroke();
                }
                
                // Draw text
                canvasContext.fillText(textElement.text, textElement.x, textElement.y);
                
                canvasContext.restore();
            });
            
            // Add signature if exists
            if (signatureData) {
                const signature = new Image();
                signature.onload = () => {
                    canvasContext.drawImage(signature, photoCanvas.width - 150, photoCanvas.height - 100, 120, 50);
                };
                signature.src = signatureData;
            }
        }
        
        // Apply background effects
        function applyBackgroundEffects() {
            if (!blurBackground.checked && !darkenBackground.checked && !addOverlay.checked) return;
            
            const imageData = canvasContext.getImageData(0, 0, photoCanvas.width, photoCanvas.height);
            const data = imageData.data;
            
            if (blurBackground.checked) {
                // Simple blur effect
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = photoCanvas.width;
                tempCanvas.height = photoCanvas.height;
                tempCtx.putImageData(imageData, 0, 0);
                
                // Apply blur
                canvasContext.filter = 'blur(5px)';
                canvasContext.drawImage(tempCanvas, 0, 0);
                canvasContext.filter = 'none';
            }
            
            if (darkenBackground.checked) {
                // Darken the image
                for (let i = 0; i < data.length; i += 4) {
                    data[i] *= 0.7;     // R
                    data[i + 1] *= 0.7; // G
                    data[i + 2] *= 0.7; // B
                }
                canvasContext.putImageData(imageData, 0, 0);
            }
            
            if (addOverlay.checked) {
                // Add color overlay
                canvasContext.fillStyle = overlayColor.value;
                canvasContext.globalAlpha = overlayOpacity.value / 100;
                canvasContext.fillRect(0, 0, photoCanvas.width, photoCanvas.height);
                canvasContext.globalAlpha = 1.0;
            }
        }
        
        // Add text to canvas
        function addTextToCanvas() {
            const name = nameText.value.trim();
            const dob = dobText.value;
            const text1 = additionalText1.value.trim();
            const text2 = additionalText2.value.trim();
            
            if (name) {
                addTextElement({
                    text: name,
                    x: photoCanvas.width / 2,
                    y: photoCanvas.height - 100,
                    fontSize: parseInt(fontSize.value),
                    color: currentColor,
                    font: currentFont
                });
            }
            
            if (dob) {
                const formattedDob = formatDate(dob, dobFormat.value);
                addTextElement({
                    text: `Date of Birth: ${formattedDob}`,
                    x: photoCanvas.width / 2,
                    y: photoCanvas.height - 60,
                    fontSize: parseInt(fontSize.value) - 4,
                    color: currentColor,
                    font: currentFont
                });
            }
            
            if (text1) {
                addTextElement({
                    text: text1,
                    x: photoCanvas.width / 2,
                    y: 50,
                    fontSize: parseInt(fontSize.value),
                    color: currentColor,
                    font: currentFont
                });
            }
            
            if (text2) {
                addTextElement({
                    text: text2,
                    x: photoCanvas.width / 2,
                    y: 100,
                    fontSize: parseInt(fontSize.value),
                    color: currentColor,
                    font: currentFont
                });
            }
            
            renderTextElements();
            showNotification('Text added to photo!');
        }
        
        // Apply changes
        function applyChanges() {
            renderTextElements();
            showNotification('Changes applied successfully!');
        }
        
        // Reset editor
        function resetEditor() {
            if (confirm('Are you sure you want to reset everything?')) {
                textElements = [];
                textLayers.innerHTML = '';
                
                if (originalImage) {
                    setupCanvas(originalImage);
                } else {
                    photoCanvas.style.display = 'none';
                    canvasPlaceholder.style.display = 'block';
                }
                
                // Reset form values
                nameText.value = 'John Smith';
                dobText.value = new Date().toISOString().split('T')[0];
                additionalText1.value = '';
                additionalText2.value = '';
                
                // Reset styling
                fontSize.value = 24;
                fontSizeValue.textContent = '24';
                fontSizeDisplay.textContent = '24px';
                textOpacity.value = 100;
                opacityValue.textContent = '100';
                opacityDisplay.textContent = '100%';
                
                showNotification('Editor reset successfully!');
            }
        }
        
        // Download image
        function downloadImage() {
            if (!currentImage) {
                showNotification('Please upload a photo first!', true);
                return;
            }
            
            const link = document.createElement('a');
            link.download = `photo-with-name-dob-${Date.now()}.png`;
            link.href = photoCanvas.toDataURL('image/png');
            link.click();
            showNotification('Photo downloaded successfully!');
        }
        
        // Share image
        function shareImage() {
            if (!currentImage) {
                showNotification('Please upload a photo first!', true);
                return;
            }
            
            photoCanvas.toBlob(blob => {
                const file = new File([blob], 'photo.png', { type: 'image/png' });
                
                if (navigator.share && navigator.canShare({ files: [file] })) {
                    navigator.share({
                        files: [file],
                        title: 'My Edited Photo',
                        text: 'Check out my edited photo with name and DOB!'
                    });
                } else {
                    // Fallback: copy to clipboard
                    photoCanvas.toBlob(blob => {
                        const item = new ClipboardItem({ 'image/png': blob });
                        navigator.clipboard.write([item]).then(() => {
                            showNotification('Image copied to clipboard!');
                        });
                    });
                }
            });
        }
        
        // Print image
        function printImage() {
            if (!currentImage) {
                showNotification('Please upload a photo first!', true);
                return;
            }
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>Print Photo</title>
                        <style>
                            body { 
                                margin: 0; 
                                padding: 20px; 
                                display: flex; 
                                justify-content: center; 
                                align-items: center; 
                                min-height: 100vh; 
                            }
                            img { 
                                max-width: 100%; 
                                height: auto; 
                                box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
                            }
                            @media print {
                                body { padding: 0; }
                            }
                        </style>
                    </head>
                    <body>
                        <img src="${photoCanvas.toDataURL('image/png')}" alt="Edited Photo">
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.focus();
            printWindow.print();
        }
        
        // Apply preset
        function applyPreset(preset) {
            switch(preset) {
                case 'id-card':
                    nameText.value = 'John Smith';
                    additionalText1.value = 'Employee ID: 12345';
                    additionalText2.value = 'Department: Marketing';
                    currentColor = '#000000';
                    currentFont = 'Arial';
                    fontSize.value = 20;
                    fontSizeValue.textContent = '20';
                    fontSizeDisplay.textContent = '20px';
                    break;
                    
                case 'certificate':
                    nameText.value = 'Jane Doe';
                    additionalText1.value = 'Certificate of Achievement';
                    additionalText2.value = 'Awarded on: ' + new Date().toLocaleDateString();
                    currentColor = '#8B4513';
                    currentFont = 'Times New Roman';
                    fontSize.value = 28;
                    fontSizeValue.textContent = '28';
                    fontSizeDisplay.textContent = '28px';
                    break;
                    
                case 'birthday':
                    nameText.value = 'Happy Birthday!';
                    additionalText1.value = 'Celebrating another year';
                    additionalText2.value = '';
                    currentColor = '#FF69B4';
                    currentFont = 'Brush Script MT';
                    fontSize.value = 32;
                    fontSizeValue.textContent = '32';
                    fontSizeDisplay.textContent = '32px';
                    break;
                    
                case 'wedding':
                    nameText.value = 'Mr. & Mrs. Smith';
                    additionalText1.value = 'Wedding Anniversary';
                    additionalText2.value = 'Since: 2010';
                    currentColor = '#800080';
                    currentFont = 'Georgia';
                    fontSize.value = 26;
                    fontSizeValue.textContent = '26';
                    fontSizeDisplay.textContent = '26px';
                    break;
                    
                case 'social-media':
                    nameText.value = '@username';
                    additionalText1.value = 'Follow for more!';
                    additionalText2.value = '';
                    currentColor = '#4267B2';
                    currentFont = 'Verdana';
                    fontSize.value = 22;
                    fontSizeValue.textContent = '22';
                    fontSizeDisplay.textContent = '22px';
                    break;
            }
            
            showNotification(`${preset.replace('-', ' ')} preset applied!`);
        }
        
        // Initialize signature canvas
        function initSignatureCanvas() {
            const ctx = signatureCanvas.getContext('2d');
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, signatureCanvas.width, signatureCanvas.height);
            
            signatureCanvas.addEventListener('mousedown', startDrawingSignature);
            signatureCanvas.addEventListener('mousemove', drawSignature);
            signatureCanvas.addEventListener('mouseup', stopDrawingSignature);
            signatureCanvas.addEventListener('mouseout', stopDrawingSignature);
            
            clearSignature.addEventListener('click', () => {
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, signatureCanvas.width, signatureCanvas.height);
            });
            
            saveSignature.addEventListener('click', () => {
                signatureData = signatureCanvas.toDataURL('image/png');
                showNotification('Signature saved!');
            });
        }
        
        function startDrawingSignature(e) {
            isDrawing = true;
            const rect = signatureCanvas.getBoundingClientRect();
            lastX = e.clientX - rect.left;
            lastY = e.clientY - rect.top;
        }
        
        function drawSignature(e) {
            if (!isDrawing) return;
            
            const ctx = signatureCanvas.getContext('2d');
            const rect = signatureCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(x, y);
            ctx.stroke();
            
            lastX = x;
            lastY = y;
        }
        
        function stopDrawingSignature() {
            isDrawing = false;
        }
        
        // Update template preview
        function updateTemplatePreview() {
            const templatePreview = document.getElementById('templatePreview');
            if (!templatePreview) return;
            
            let html = '';
            
            switch(currentTemplate) {
                case 'id-card':
                    html = `
                        <div style="width: 350px; height: 200px; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 2px solid #ddd;">
                            <div style="display: flex; align-items: center; gap: 20px;">
                                <div style="width: 80px; height: 80px; background: #f0f0f0; border-radius: 5px; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-user" style="font-size: 40px; color: #ccc;"></i>
                                </div>
                                <div>
                                    <h3 style="margin: 0; color: #333;">John Smith</h3>
                                    <p style="margin: 5px 0; color: #666;">Employee ID: 12345</p>
                                    <p style="margin: 5px 0; color: #666;">DOB: 15/05/1990</p>
                                </div>
                            </div>
                            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
                                <p style="margin: 0; color: #888; font-size: 0.9rem;">Acme Corporation</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'certificate':
                    html = `
                        <div style="width: 500px; height: 350px; background: linear-gradient(45deg, #fff8e1, #ffecb3); border: 20px solid #8B4513; padding: 30px; text-align: center; position: relative;">
                            <div style="border: 2px solid #8B4513; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px;">
                                <h1 style="color: #8B4513; margin: 0; font-family: 'Times New Roman';">Certificate of Achievement</h1>
                                <p style="color: #666; margin: 20px 0;">This certifies that</p>
                                <h2 style="color: #8B4513; margin: 10px 0; border-bottom: 2px solid #8B4513; padding-bottom: 10px;">Jane Doe</h2>
                                <p style="color: #666; margin: 10px 0;">has successfully completed the requirements</p>
                                <p style="color: #666; margin-top: 20px;">Date: ${new Date().toLocaleDateString()}</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'birth-certificate':
                    html = `
                        <div style="width: 450px; height: 300px; background: #f8f9ff; border: 2px solid #4a90e2; padding: 25px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                            <h2 style="color: #4a90e2; text-align: center; margin: 0 0 20px 0;">Birth Certificate</h2>
                            <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                                <div style="flex: 1;">
                                    <p style="margin: 10px 0;"><strong>Child's Name:</strong> Baby Smith</p>
                                    <p style="margin: 10px 0;"><strong>Date of Birth:</strong> 15/05/2023</p>
                                    <p style="margin: 10px 0;"><strong>Time of Birth:</strong> 14:30</p>
                                </div>
                                <div style="flex: 1;">
                                    <p style="margin: 10px 0;"><strong>Weight:</strong> 3.2 kg</p>
                                    <p style="margin: 10px 0;"><strong>Length:</strong> 50 cm</p>
                                    <p style="margin: 10px 0;"><strong>Hospital:</strong> City General</p>
                                </div>
                            </div>
                            <div style="text-align: center; margin-top: 20px;">
                                <p style="color: #666;">Official Document</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                default:
                    html = `
                        <div style="text-align: center; color: #666;">
                            <i class="fas fa-th-large" style="font-size: 60px; color: #ccc; margin-bottom: 20px;"></i>
                            <p>Select a template to preview</p>
                        </div>
                    `;
            }
            
            templatePreview.innerHTML = html;
        }
        
        // Apply template
        function applyTemplate() {
            if (!currentImage) {
                showNotification('Please upload a photo first!', true);
                return;
            }
            
            // Update canvas size based on template
            let width = photoCanvas.width;
            let height = photoCanvas.height;
            
            switch(templateSize.value) {
                case 'passport':
                    width = 400;
                    height = 400;
                    break;
                case 'a4':
                    width = 595;
                    height = 842;
                    break;
                case 'square':
                    width = 1080;
                    height = 1080;
                    break;
                case 'custom':
                    width = parseInt(customWidth.value) || width;
                    height = parseInt(customHeight.value) || height;
                    break;
            }
            
            photoCanvas.width = width;
            photoCanvas.height = height;
            
            // Apply background color
            canvasContext.fillStyle = templateBgColor.value;
            canvasContext.fillRect(0, 0, width, height);
            
            // Draw original image
            const imgWidth = width * 0.6;
            const imgHeight = height * 0.6;
            canvasContext.drawImage(currentImage, (width - imgWidth) / 2, (height - imgHeight) / 2, imgWidth, imgHeight);
            
            // Apply border
            if (borderStyle.value !== 'none') {
                canvasContext.strokeStyle = '#000000';
                canvasContext.lineWidth = 5;
                
                if (borderStyle.value === 'dashed') {
                    canvasContext.setLineDash([10, 5]);
                } else if (borderStyle.value === 'dotted') {
                    canvasContext.setLineDash([2, 5]);
                } else if (borderStyle.value === 'double') {
                    canvasContext.strokeRect(10, 10, width - 20, height - 20);
                    canvasContext.strokeRect(15, 15, width - 30, height - 30);
                } else {
                    canvasContext.strokeRect(0, 0, width, height);
                }
                
                canvasContext.stroke();
                canvasContext.setLineDash([]);
            }
            
            showNotification('Template applied successfully!');
        }
        
        // Add watermark
        function addWatermark() {
            if (!currentImage) {
                showNotification('Please upload a photo first!', true);
                return;
            }
            
            const watermarkText = '© ' + new Date().getFullYear() + ' ' + (nameText.value || 'Your Name');
            
            canvasContext.save();
            canvasContext.globalAlpha = 0.3;
            canvasContext.font = '20px Arial';
            canvasContext.fillStyle = '#ffffff';
            canvasContext.textAlign = 'center';
            canvasContext.textBaseline = 'middle';
            
            // Create pattern watermark
            for (let x = 50; x < photoCanvas.width; x += 200) {
                for (let y = 50; y < photoCanvas.height; y += 100) {
                    canvasContext.save();
                    canvasContext.translate(x, y);
                    canvasContext.rotate(-0.5);
                    canvasContext.fillText(watermarkText, 0, 0);
                    canvasContext.restore();
                }
            }
            
            canvasContext.restore();
            showNotification('Watermark added!');
        }
        
        // Show notification
        function showNotification(message, isError = false) {
            notification.querySelector('span').textContent = message;
            notification.className = 'notification';
            
            if (isError) {
                notification.classList.add('error');
                notification.querySelector('i').className = 'fas fa-exclamation-circle';
            } else {
                notification.querySelector('i').className = 'fas fa-check-circle';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Initialize template preview
        updateTemplatePreview();
        
        // Update template preview when size changes
        templateSize.addEventListener('change', updateTemplatePreview);
        
        // Update template preview when color changes
        templateBgColor.addEventListener('input', updateTemplatePreview);
        
        // Update template preview when border changes
        borderStyle.addEventListener('change', updateTemplatePreview);
    </script>
</body>
</html>
