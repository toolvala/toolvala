
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfect Layout Word to PDF</title>
    
    <!-- Required Libraries -->
    <script src="https://unpkg.com/jszip/dist/jszip.min.js"></script>
    <script src="https://unpkg.com/docx-preview/dist/docx-preview.min.js"></script>
    
    <!-- Google Fonts for better Hindi rendering -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&family=Tiro+Devanagari+Hindi&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #f3f4f6;
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
        }

        .controls {
            background: white;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto 20px auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }

        h1 { margin: 0 0 10px 0; color: #1e3a8a; }

        .btn-upload {
            background: #eff6ff;
            color: #1e40af;
            border: 2px dashed #3b82f6;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
        }

        .btn-print {
            background: #16a34a;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-print:hover { background: #15803d; }
        .btn-print:disabled { background: #ccc; cursor: not-allowed; }

        /* --- THE PREVIEWER (Fixes the Layout) --- */
        
        .preview-window {
            overflow: auto; /* Scrollbar if screen is small */
            background: #525659;
            padding: 40px;
            display: flex;
            justify-content: center;
        }

        #doc-container {
            background: white;
            /* CRITICAL FIX: Lock Width to A4 size so text doesn't wrap */
            width: 794px; /* Exact width of A4 at 96 DPI */
            min-height: 1123px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            margin: 0 auto;
        }

        /* Styles specifically for the document content */
        .docx-wrapper { padding: 0 !important; background: white !important; }
        
        /* Force Graphics/Logos to show */
        .docx-wrapper > section { 
            padding: 40px !important; /* Internal Page Margins */
            width: auto !important; 
            margin-bottom: 0 !important;
            box-shadow: none !important;
        }

        /* --- PRINT PDF SETTINGS --- */
        @media print {
            body { background: white; margin: 0; padding: 0; }
            .controls, .preview-window { padding: 0; margin: 0; background: white; }
            body > *:not(.preview-window) { display: none !important; }
            
            /* Remove scrollbars for print */
            .preview-window { overflow: visible; display: block; }
            
            #doc-container {
                width: 100%; /* Fill paper width */
                margin: 0;
                box-shadow: none;
                border: none;
            }

            @page {
                size: A4 portrait;
                margin: 0; /* Let Word handle the margins internally */
            }

            /* Better Graphics Rendering */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
    </style>
</head>
<body>

<div class="controls">
    <h1>Word to PDF Layout Fixer</h1>
    <p>Upload .docx &rarr; Check Layout &rarr; Save as PDF</p>
    
    <label class="btn-upload">
        üìÇ Select Word File
        <input type="file" id="wordFile" accept=".docx" style="display:none">
    </label>
    <br>
    <button id="printBtn" class="btn-print" disabled>üñ®Ô∏è Save as PDF</button>
    <p id="msg" style="margin-top:10px; font-weight:bold; color:#666;"></p>
</div>

<!-- Preview Area -->
<div class="preview-window">
    <div id="doc-container">
        <div style="padding:100px; text-align:center; color:#ccc;">
            Document will appear here exactly as A4 size.
        </div>
    </div>
</div>

<script>
    const fileInput = document.getElementById('wordFile');
    const container = document.getElementById('doc-container');
    const printBtn = document.getElementById('printBtn');
    const msg = document.getElementById('msg');

    fileInput.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        printBtn.disabled = true;
        msg.innerText = "Loading layout...";
        
        try {
            const arrayBuffer = await file.arrayBuffer();
            
            const options = {
                className: "docx-content",
                inWrapper: true,
                ignoreWidth: false, // Keep Word widths
                experimental: true, // Needed for LOGOS
                breakPages: true
            };

            await docx.renderAsync(arrayBuffer, container, null, options);
            
            printBtn.disabled = false;
            msg.innerText = "‚úÖ Preview Loaded. If spacing looks correct, click Save as PDF.";
            msg.style.color = "green";

        } catch (error) {
            console.error(error);
            msg.innerText = "‚ùå Error reading file.";
        }
    });

    printBtn.addEventListener('click', () => {
        window.print();
    });
</script>

</body>
</html>
