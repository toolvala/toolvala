<!DOCTYPE html>
<html lang="en">
<head>
    <!-- =========================================
         SEO & META DATA
         ========================================= -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Free PDF Signer Online | Sign Documents Securely - Toolvala</title>
    
    <meta name="description" content="Sign PDF documents online for free with Toolvala. Draw your electronic signature and sign contracts instantly. 100% Client-Side secure, no server uploads required.">
    <meta name="keywords" content="sign pdf online, toolvala pdf signer, free electronic signature, sign pdf without adobe, client side pdf tool, draw signature on pdf, sign pdf mobile, pdf signer india">
    
    <!-- CANONICAL URL -->
    <link rel="canonical" href="https://www.toolvala.in/sign-pdf.html">
    
    <meta name="robots" content="index, follow">

    <!-- OPEN GRAPH (Social Media) -->
    <meta property="og:site_name" content="Toolvala">
    <meta property="og:title" content="Free PDF Signer - Secure & Private | Toolvala">
    <meta property="og:description" content="Sign your PDF documents directly in your browser. No server uploads. 100% Free and Secure.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.toolvala.in/sign-pdf.html">
    <meta property="og:image" content="https://www.toolvala.in/assets/og-signer.jpg">

    <!-- LIBRARIES -->
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <!-- SCHEMA MARKUP -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Toolvala PDF Signer",
      "url": "https://www.toolvala.in/sign-pdf.html",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "INR"
      },
      "description": "A browser-based tool to electronically sign PDF documents without uploading data to a server."
    }
    </script>

    <style>
        :root {
            --brand: #2563eb;         /* Royal Blue */
            --brand-dark: #1e40af;
            --accent: #f59e0b;        /* Amber */
            --bg: #f8fafc;
            --surface: #ffffff;
            --text-main: #0f172a;
            --text-light: #64748b;
            --border: #e2e8f0;
            --success: #16a34a;
            --error: #dc2626;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            line-height: 1.7;
        }

        /* --- NAVIGATION --- */
        .navbar {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 15px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .nav-container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--brand);
            text-decoration: none;
            letter-spacing: -0.5px;
        }
        .logo span { color: var(--text-main); }
        
        /* --- LAYOUT --- */
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* --- HERO --- */
        .hero {
            text-align: center;
            padding: 40px 20px;
        }
        h1 { font-size: 2.8rem; color: var(--text-main); margin-bottom: 15px; line-height: 1.1; font-weight: 800; }
        h1 span { color: var(--brand); }
        .hero-sub { font-size: 1.2rem; color: var(--text-light); max-width: 700px; margin: 0 auto 30px; }

        /* --- TOOL BOX --- */
        .tool-wrapper {
            background: var(--surface);
            border-radius: 16px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border);
            padding: 30px;
            margin-bottom: 60px;
        }

        .step-row {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .step-col { flex: 1; min-width: 280px; }

        .section-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .badge { background: var(--brand); color: white; width: 24px; height: 24px; border-radius: 50%; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; }

        /* Upload */
        .upload-zone {
            border: 2px dashed #cbd5e1;
            background: #f1f5f9;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .upload-zone:hover { border-color: var(--brand); background: #eff6ff; }
        
        /* Canvas */
        .canvas-container {
            position: relative;
            background: white;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            height: 200px;
            cursor: crosshair;
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        canvas { width: 100%; height: 100%; touch-action: none; }

        /* Controls */
        .control-panel {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            border: 1px solid var(--border);
        }
        label { display: block; font-size: 0.85rem; font-weight: 600; margin-bottom: 5px; color: var(--text-main); }
        select, input { width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 4px; box-sizing: border-box; }

        /* Buttons */
        .btn-primary {
            background: var(--brand); color: white; border: none; padding: 15px 30px;
            border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 1.1rem; width: 100%;
            transition: all 0.2s;
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.2);
        }
        .btn-primary:hover { background: var(--brand-dark); transform: translateY(-1px); }
        .btn-primary:disabled { background: #94a3b8; cursor: not-allowed; transform: none; box-shadow: none; }
        
        .btn-ghost { background: transparent; color: var(--error); border: 1px solid var(--error); padding: 5px 10px; border-radius: 4px; font-size: 0.8rem; cursor: pointer; float: right; }
        .btn-ghost:hover { background: #fef2f2; }

        /* --- RELATED TOOLS --- */
        .related-tools {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0 60px 0;
        }
        .tool-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            text-align: center;
            text-decoration: none;
            color: var(--text-main);
            transition: 0.2s;
        }
        .tool-card:hover { border-color: var(--brand); transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .tool-icon { font-size: 2rem; display: block; margin-bottom: 10px; }
        .tool-name { font-weight: 700; display: block; }

        /* --- SEO CONTENT --- */
        .content-area {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }
        .content-area h2 { color: var(--brand-dark); font-size: 1.8rem; margin-top: 40px; border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; }
        .content-area h3 { color: var(--text-main); font-size: 1.4rem; margin-top: 30px; }
        .content-area p { margin-bottom: 20px; color: #334155; }
        .content-area ul, .content-area ol { margin-bottom: 25px; padding-left: 25px; color: #334155; }
        .content-area li { margin-bottom: 10px; }
        
        .alert-box {
            background: #ecfdf5; border-left: 4px solid var(--success); padding: 20px; margin: 30px 0; border-radius: 4px;
        }
        .status-msg { margin-top: 10px; font-weight: 600; font-size: 0.9rem; text-align: center; }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .step-row { flex-direction: column; }
            .content-area { padding: 20px; }
        }
    </style>
</head>
<body>

    <!-- NAVIGATION -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="https://www.toolvala.in" class="logo">Tool<span>vala</span></a>
            <div style="font-size: 0.9rem; color: var(--text-light);">Free Online PDF Tools</div>
        </div>
    </nav>

    <!-- HEADER -->
    <header class="container hero">
        <h1>Sign PDF <span>Online Free</span></h1>
        <p class="hero-sub">Securely add your handwritten signature to PDF documents. No software installation, no server uploads‚Äî100% private.</p>
    </header>

    <!-- MAIN APP -->
    <main class="container">
        <div class="tool-wrapper">
            
            <div class="step-row">
                <!-- Step 1: Upload -->
                <div class="step-col">
                    <div class="section-title"><span class="badge">1</span> Upload Document</div>
                    <div class="upload-zone" onclick="document.getElementById('pdfInput').click()">
                        <div style="font-size: 2.5rem; margin-bottom: 10px;">üìÑ</div>
                        <strong>Select PDF File</strong>
                        <div style="font-size: 0.8rem; color: #64748b; margin-top: 5px;">(Processed locally on device)</div>
                    </div>
                    <input type="file" id="pdfInput" accept="application/pdf" style="display: none">
                    <div id="fileStatus" class="status-msg"></div>
                </div>

                <!-- Step 2: Draw -->
                <div class="step-col">
                    <div class="section-title">
                        <span class="badge">2</span> Draw Signature
                        <button class="btn-ghost" id="clearBtn">Clear</button>
                    </div>
                    <div class="canvas-container" id="canvasContainer">
                        <canvas id="sigCanvas"></canvas>
                    </div>
                </div>
            </div>

            <!-- Step 3: Settings -->
            <div class="section-title"><span class="badge">3</span> Customize Position</div>
            <div class="control-panel">
                <div>
                    <label>Page Number</label>
                    <input type="number" id="pageNumber" min="1" value="1">
                    <small id="pageCountDisplay" style="color: #64748b;">Pages: 0</small>
                </div>
                <div>
                    <label>Position Preset</label>
                    <select id="positionPreset">
                        <option value="br">Bottom Right</option>
                        <option value="bl">Bottom Left</option>
                        <option value="bc">Bottom Center</option>
                        <option value="c">Center</option>
                    </select>
                </div>
                <div>
                    <label>Signature Size</label>
                    <input type="range" id="sigScale" min="0.1" max="1.5" step="0.1" value="0.4">
                </div>
                <div>
                    <label>Vertical Adjust</label>
                    <input type="range" id="yOffset" min="-300" max="300" value="0">
                </div>
            </div>

            <!-- Action -->
            <div style="margin-top: 30px; text-align: center;">
                <button id="downloadBtn" class="btn-primary" disabled>‚¨á Download Signed PDF</button>
                <div id="processStatus" class="status-msg"></div>
            </div>

        </div>

        <!-- RELATED TOOLS LINKS -->
        <h3 style="text-align: center; color: var(--text-light);">More Free Tools from Toolvala</h3>
        <div class="related-tools">
            <a href="pdf-compressor.html" class="tool-card">
                <span class="tool-icon">üóúÔ∏è</span>
                <span class="tool-name">Compress PDF</span>
            </a>
            <a href="pdf-merger.html" class="tool-card">
                <span class="tool-icon">üîó</span>
                <span class="tool-name">Merge PDFs</span>
            </a>
            <a href="pdf-to-image-converter.html" class="tool-card">
                <span class="tool-icon">üñºÔ∏è</span>
                <span class="tool-name">PDF to Image</span>
            </a>
        </div>
    </main>

    <!-- SEO CONTENT ARTICLE (2000 Words Strategy) -->
    <article class="container content-area">
        
        <h2>The Ultimate Guide to Signing PDFs Online with Toolvala</h2>
        <p>In the modern digital landscape, the ability to <strong>sign PDF documents online</strong> is not just a convenience‚Äîit is a necessity. Gone are the days of the archaic "Print, Sign, Scan, and Send" workflow that wastes paper, ink, and valuable time. Whether you are a freelancer closing a deal, a tenant securing a lease, or a business owner approving an invoice, <strong>Toolvala</strong> provides a seamless, secure, and free solution to execute your documents electronically.</p>

        <p>This comprehensive guide explores everything you need to know about electronic signatures, the technology behind our secure client-side tool, and why Toolvala is your best choice for PDF manipulation.</p>

        <div class="alert-box">
            <strong>üîí Security Guarantee:</strong> Toolvala uses advanced HTML5 and WebAssembly technology. Your documents are processed <strong>locally in your browser</strong>. We do not have servers that store, view, or analyze your files. Your data remains 100% private on your device.
        </div>

        <h3>Why Choose Toolvala for PDF Signing?</h3>
        <p>There are hundreds of PDF tools on the internet. However, many of them come with hidden costs, watermarks, or questionable privacy policies. Here is why Toolvala stands out:</p>
        <ul>
            <li><strong>Zero Cost:</strong> Our tool is completely free. There are no "Pro" subscriptions required to download your signed file.</li>
            <li><strong>No Watermarks:</strong> We believe your documents should look professional. We do not stamp our logo on your contracts.</li>
            <li><strong>No Registration:</strong> You do not need to create an account, provide an email address, or sign up for a newsletter to use this tool.</li>
            <li><strong>Cross-Platform Compatibility:</strong> Because Toolvala runs in the browser, it works perfectly on Windows, macOS, Linux, Android, and iOS (iPhone/iPad).</li>
            <li><strong>Instant Speed:</strong> Since there is no file upload to a remote server, large files (contracts, blueprints, thesis papers) load and save instantly.</li>
        </ul>

        <h2>Step-by-Step: How to Sign a PDF Document</h2>
        <p>Using the Toolvala PDF Signer is intuitive. Follow this detailed walkthrough to ensure a perfect result every time.</p>

        <h4>Step 1: Document Upload</h4>
        <p>Click on the "Upload Document" area at the top of the tool. You can select any standard PDF file from your computer or mobile device. Once selected, the tool reads the file structure to determine the number of pages. You will see a "Loaded" confirmation message.</p>

        <h4>Step 2: Create Your Signature</h4>
        <p>This is the fun part. In the "Draw Signature" canvas box:</p>
        <ul>
            <li><strong>Desktop Users:</strong> Click and hold your left mouse button to draw your signature. Move your mouse smoothly to create curves.</li>
            <li><strong>Mobile/Tablet Users:</strong> This is where Toolvala shines. Use your finger or a stylus (like an Apple Pencil) to draw on the screen. This usually results in the most natural-looking signature.</li>
        </ul>
        <p><em>Mistake?</em> No problem. Click the "Clear" button to wipe the canvas and try again until you are satisfied.</p>

        <h4>Step 3: Placement and Customization</h4>
        <p>Unlike basic tools that just slap an image in the corner, Toolvala gives you control:</p>
        <ol>
            <li><strong>Select Page:</strong> If your contract is 15 pages long, but you only need to sign page 15, enter "15" in the Page Number box.</li>
            <li><strong>Position Preset:</strong> Choose a starting point. "Bottom Right" is standard for most contracts.</li>
            <li><strong>Fine Tuning:</strong> Use the "Vertical Adjust" slider. This moves the signature up or down by pixels. Use this to align your drawn name exactly on the dotted line (e.g., Signature: _________).</li>
            <li><strong>Scaling:</strong> Is the signature too big? Use the "Size" slider to shrink it down to fit the space.</li>
        </ol>

        <h4>Step 4: Download</h4>
        <p>Click the "Download Signed PDF" button. Your browser will instantly generate a new PDF file containing your signature image embedded into the document. Save it to your device and you are ready to email it.</p>

        <h2>Electronic Signatures vs. Digital Signatures</h2>
        <p>It is important to understand the terminology in the world of digital documentation. Toolvala provides an <strong>Electronic Signature (eSignature)</strong>.</p>

        <h3>Electronic Signature (eSign)</h3>
        <p>An electronic signature is a visual representation of a person's intent to agree to the content of a document. In the eyes of many legal frameworks (such as the US ESIGN Act of 2000 and the EU eIDAS regulation), an electronic signature is legally binding for the vast majority of business transactions. This includes:</p>
        <ul>
            <li>Sales contracts and purchase orders.</li>
            <li>Employment offer letters.</li>
            <li>Rental and lease agreements.</li>
            <li>Non-Disclosure Agreements (NDAs).</li>
            <li>Permission slips and liability waivers.</li>
        </ul>

        <h3>Digital Signature (Cryptographic)</h3>
        <p>A "Digital Signature" refers to a specific technical implementation involving cryptographic keys and digital certificates issued by a Certificate Authority (CA). These are often required for highly regulated government filings or specific banking procedures. Toolvala provides the visual eSignature, which covers 99% of everyday use cases for freelancers, students, and small businesses.</p>

        <h2>The Importance of Client-Side Security</h2>
        <p>Security is the number one concern when uploading files to the internet. Standard online PDF converters work by sending your file to a cloud server (often hosted in a different country). That server processes the file and sends it back. While many services are reputable, this process introduces risk:</p>
        <ul>
            <li><strong>Data Breaches:</strong> If the server is hacked, your documents could be exposed.</li>
            <li><strong>Data Retention:</strong> Even if they promise to delete files, errors happen.</li>
            <li><strong>Man-in-the-Middle Attacks:</strong> Interception during the upload process.</li>
        </ul>
        <p><strong>The Toolvala Solution:</strong> We utilize WebAssembly and JavaScript libraries (like PDF-Lib) that run strictly inside your Chrome, Firefox, Safari, or Edge browser. When you "upload" a file to Toolvala, it is actually just being loaded into your computer's RAM. It never travels over the internet. You can technically load the page, turn off your Wi-Fi, and the tool will still work perfectly.</p>

        <h2>Common Use Cases for Toolvala</h2>

        <h3>1. Real Estate Professionals</h3>
        <p>Real estate agents need to get leases and addendums signed quickly. With Toolvala, an agent can open a contract on their iPad, sign it immediately while standing in the property, and email it to the landlord. No office visit required.</p>

        <h3>2. Human Resources (HR)</h3>
        <p>Onboarding new employees involves mountains of paperwork. Sending PDFs that employees can sign on their phones reduces the friction of printing and scanning, leading to faster hiring turnaround times.</p>

        <h3>3. Freelancers and Contractors</h3>
        <p>Sending a Statement of Work (SOW) or an Invoice? Sign it professionally before sending. A signed invoice often looks more authoritative and can sometimes lead to faster payment processing compared to a plain text document.</p>

        <h3>4. Education and Academic Research</h3>
        <p>Students often need to submit signed declarations with their thesis or assignments. Toolvala allows students to sign these documents from the library or dorm room without hunting for a scanner.</p>

        <h2>Frequently Asked Questions (FAQ)</h2>

        <h3>Is Toolvala really free?</h3>
        <p>Yes. We provide this tool as a free utility. There are no paywalls for the signing feature.</p>

        <h3>Can I change the color of the signature ink?</h3>
        <p>Currently, the tool uses standard black ink, which is the most professional standard for legal documents. We may add blue ink options in future updates.</p>

        <h3>Does the signature have a transparent background?</h3>
        <p>Yes! Our drawing algorithm automatically handles transparency. This means you can place your signature over lines or lightly colored backgrounds without a white box blocking the text behind it.</p>

        <h3>Why can't I edit the text in the PDF?</h3>
        <p>This tool is specifically designed as a "Signer." Editing existing text in a PDF is a much more complex process involving font matching and layout reconstruction. If you need to merge files or compress them, please check our <a href="pdf-merger.html">PDF Merger</a> or <a href="pdf-compressor.html">PDF Compressor</a> tools.</p>

        <h3>Can I sign multiple pages at once?</h3>
        <p>Currently, the tool places the signature on one page at a time to ensure precision. If you need to sign multiple pages, you can sign one, download the file, re-upload the signed file, and sign the next page.</p>

        <h3>My PDF is password protected. Can I sign it?</h3>
        <p>If your PDF is encrypted with a user password, you will need to unlock it first. Browser-based tools generally cannot modify encrypted files without the password being removed first for security reasons.</p>

        <h2>Conclusion</h2>
        <p>Toolvala is dedicated to making PDF management easy, secure, and free. By using our <strong>Online PDF Signer</strong>, you are saving time, saving trees, and keeping your data secure on your own device. Bookmark <strong>toolvala.in</strong> for all your future document needs, including compression, merging, and conversion.</p>

    </article>

    <!-- FOOTER -->
    <footer style="background: #1e293b; color: white; padding: 40px 20px; text-align: center; margin-top: 50px;">
        <div class="container">
            <div style="font-size: 1.5rem; font-weight: 800; margin-bottom: 20px;">Toolvala</div>
            <div style="margin-bottom: 20px;">
                <a href="https://www.toolvala.in" style="color: #cbd5e1; text-decoration: none; margin: 0 10px;">Home</a>
                <a href="pdf-compressor.html" style="color: #cbd5e1; text-decoration: none; margin: 0 10px;">Compressor</a>
                <a href="pdf-merger.html" style="color: #cbd5e1; text-decoration: none; margin: 0 10px;">Merger</a>
                <a href="pdf-to-image-converter.html" style="color: #cbd5e1; text-decoration: none; margin: 0 10px;">Converter</a>
            </div>
            <p style="color: #64748b; font-size: 0.9rem;">&copy; 2024 Toolvala.in. All rights reserved. Secure Client-Side Processing.</p>
        </div>
    </footer>

    <!-- LOGIC SCRIPT -->
    <script>
        const { PDFDocument } = PDFLib;

        // --- DOM Elements ---
        const pdfInput = document.getElementById('pdfInput');
        const fileStatus = document.getElementById('fileStatus');
        const canvas = document.getElementById('sigCanvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('canvasContainer');
        const clearBtn = document.getElementById('clearBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const processStatus = document.getElementById('processStatus');
        
        // --- Inputs ---
        const pageNumInput = document.getElementById('pageNumber');
        const pageCountDisplay = document.getElementById('pageCountDisplay');
        const posPreset = document.getElementById('positionPreset');
        const sigScale = document.getElementById('sigScale');
        const yOffset = document.getElementById('yOffset');

        // --- State ---
        let pdfBuffer = null;
        let isDrawing = false;
        let hasSignature = false;
        let totalPages = 0;

        // 1. Canvas Setup
        function resizeCanvas() {
            // Set canvas resolution to match display size
            canvas.width = container.offsetWidth;
            canvas.height = container.offsetHeight;
            
            // Style
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = '#000';
        }
        window.addEventListener('resize', resizeCanvas);
        setTimeout(resizeCanvas, 100);

        // 2. Draw Events
        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            let cx, cy;
            if(e.touches && e.touches.length > 0) {
                cx = e.touches[0].clientX;
                cy = e.touches[0].clientY;
            } else {
                cx = e.clientX;
                cy = e.clientY;
            }
            return { x: cx - rect.left, y: cy - rect.top };
        }

        const startDraw = (e) => {
            isDrawing = true;
            const {x, y} = getPos(e);
            ctx.beginPath();
            ctx.moveTo(x, y);
            if(e.type === 'touchstart') e.preventDefault();
        };

        const moveDraw = (e) => {
            if(!isDrawing) return;
            const {x, y} = getPos(e);
            ctx.lineTo(x, y);
            ctx.stroke();
            hasSignature = true;
            checkReady();
            if(e.type === 'touchmove') e.preventDefault();
        };

        const endDraw = () => { isDrawing = false; };

        canvas.addEventListener('mousedown', startDraw);
        canvas.addEventListener('touchstart', startDraw, {passive: false});
        canvas.addEventListener('mousemove', moveDraw);
        canvas.addEventListener('touchmove', moveDraw, {passive: false});
        canvas.addEventListener('mouseup', endDraw);
        canvas.addEventListener('touchend', endDraw);
        canvas.addEventListener('mouseleave', endDraw);

        clearBtn.addEventListener('click', () => {
            ctx.clearRect(0,0, canvas.width, canvas.height);
            hasSignature = false;
            checkReady();
        });

        // 3. File Upload
        pdfInput.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if(!file) return;
            
            if(file.type !== 'application/pdf') {
                fileStatus.innerHTML = '<span style="color:var(--error)">‚ùå Valid PDF Required</span>';
                return;
            }

            try {
                fileStatus.innerHTML = '‚è≥ Processing...';
                const buffer = await file.arrayBuffer();
                pdfBuffer = buffer;
                
                const doc = await PDFDocument.load(buffer);
                totalPages = doc.getPageCount();
                
                pageNumInput.max = totalPages;
                pageCountDisplay.innerText = `Total Pages: ${totalPages}`;
                fileStatus.innerHTML = `<span style="color:var(--success)">‚úÖ Ready: ${file.name}</span>`;
                checkReady();
            } catch (err) {
                console.error(err);
                fileStatus.innerHTML = '<span style="color:var(--error)">‚ùå Error reading PDF</span>';
            }
        });

        // 4. Check Ready
        function checkReady() {
            if(pdfBuffer && hasSignature) {
                downloadBtn.disabled = false;
                downloadBtn.style.opacity = "1";
                downloadBtn.innerText = "‚¨á Download Signed PDF";
            } else {
                downloadBtn.disabled = true;
                downloadBtn.style.opacity = "0.6";
                downloadBtn.innerText = pdfBuffer ? "Draw Signature First..." : "Upload PDF First...";
            }
        }

        // 5. Download Logic
        downloadBtn.addEventListener('click', async () => {
            if(!pdfBuffer || !hasSignature) return;
            processStatus.innerText = "Processing...";

            try {
                // Get Image
                const imgUrl = canvas.toDataURL('image/png');
                const imgBytes = await fetch(imgUrl).then(r => r.arrayBuffer());

                // Load Doc
                const doc = await PDFDocument.load(pdfBuffer);
                const img = await doc.embedPng(imgBytes);
                
                // Get Page
                let pNum = parseInt(pageNumInput.value) - 1;
                if(pNum < 0) pNum = 0;
                if(pNum >= totalPages) pNum = totalPages - 1;
                const page = doc.getPages()[pNum];
                
                // Calc Pos
                const { width, height } = page.getSize();
                const scale = parseFloat(sigScale.value);
                const dims = img.scale(scale);
                
                const margin = 50;
                let x, y;
                const preset = posPreset.value;

                if(preset.includes('r')) x = width - dims.width - margin;
                else if(preset.includes('l')) x = margin;
                else x = (width - dims.width) / 2;

                const vOffset = parseInt(yOffset.value);
                // PDF coords: 0,0 is bottom left
                if(preset === 'c') y = (height - dims.height)/2 + vOffset;
                else y = margin + vOffset;

                // Draw
                page.drawImage(img, {
                    x: x, y: y,
                    width: dims.width,
                    height: dims.height
                });

                // Save
                const pdfBytes = await doc.save();
                const blob = new Blob([pdfBytes], {type: 'application/pdf'});
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'Toolvala-Signed.pdf';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                processStatus.innerHTML = '<span style="color:var(--success)">‚úÖ Download Started!</span>';
            } catch(e) {
                console.error(e);
                processStatus.innerHTML = '<span style="color:var(--error)">‚ùå Processing Failed</span>';
            }
        });
    </script>
</body>
</html>
